[{"E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\index.js":"1","E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\App.js":"2","E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\utils.js":"3","E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\components\\Modal\\index.js":"4","E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\components\\DataTable\\index.js":"5"},{"size":228,"mtime":1637205214025,"results":"6","hashOfConfig":"7"},{"size":1952,"mtime":1638762574084,"results":"8","hashOfConfig":"7"},{"size":11351,"mtime":1639092539358,"results":"9","hashOfConfig":"7"},{"size":549,"mtime":1638765587395,"results":"10","hashOfConfig":"7"},{"size":702,"mtime":1638908853095,"results":"11","hashOfConfig":"7"},{"filePath":"12","messages":"13","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"11bnzc8",{"filePath":"14","messages":"15","errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"16"},{"filePath":"17","messages":"18","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":1,"source":"19"},{"filePath":"20","messages":"21","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"22"},{"filePath":"23","messages":"24","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"25"},"E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\index.js",[],"E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\App.js",["26","27","28","29"],"import './App.css';\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { LiteGraph } from 'litegraph.js';\r\nimport 'litegraph.js/css/litegraph.css';\r\nimport { init, getSQL, convertToJson } from './utils';\r\nimport Modal from './components/Modal';\r\nconst { operations } = require('./schemas/operations.json');\r\n\r\nfunction App() {\r\n  var graph;\r\n  var canvasRef = useRef(null);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [query, setQuery] = useState('');\r\n  const [result, setResult] = useState([]);\r\n  const [keys, setKeys] = useState([]);\r\n\r\n  const setResponse = (query, result, keys) => {\r\n    setQuery(query);\r\n    setResult(result);\r\n    setKeys(keys);\r\n  }\r\n\r\n  const setShowModalWrapper = (b) => {\r\n    getSQL(graph);\r\n    setShowModal(b);\r\n  }\r\n\r\n  useEffect(() => {\r\n\r\n    const handleResize = () => {\r\n      const ctx = canvasRef.current.getContext('2d');\r\n      ctx.canvas.width = window.innerWidth;\r\n      ctx.canvas.height = window.innerHeight;\r\n    };\r\n\r\n    const handleKeyDown = (e) => {\r\n      if (e.key === 's') {\r\n        getSQL();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    handleResize();\r\n\r\n    graph = new LiteGraph.LGraph();\r\n    graph.configure({\r\n    });\r\n\r\n\r\n\r\n    var canvas = new LiteGraph.LGraphCanvas(\"#mycanvas\", graph);\r\n\r\n    graph.start()\r\n    LiteGraph.clearRegisteredTypes()\r\n\r\n\r\n    init(graph, setShowModalWrapper, setResponse);\r\n    var displayNode = LiteGraph.createNode(\"Display/Display\");\r\n    displayNode.pos = [window.innerWidth / 2, window.innerHeight / 2];\r\n    graph.add(displayNode);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <canvas ref={canvasRef} id='mycanvas' width='1024' height='720'></canvas>\r\n      <Modal showModal={showModal} setShowModal={setShowModal} query={query} result={result} keys={keys}></Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\utils.js",["30","31","32"],"import { LiteGraph } from 'litegraph.js';\r\nimport axios from 'axios';\r\nconst { tables } = require('./schemas/tables.json');\r\n\r\nvar graph;\r\nlet setResponse;\r\n\r\nconst init = (g, showModal, r) => {\r\n    graph = g;\r\n    setResponse = r;\r\n\r\n    createEntityBlocks();\r\n    createFilterBlock();\r\n    createProjectionBlock();\r\n    creatCountBlock();\r\n    createForEachBlock();\r\n    createDisplayBlock(showModal);\r\n};\r\n\r\nconst createEntityBlocks = () => {\r\n    for (let table of tables) {\r\n        let name = table.name_;\r\n        function EntityNode() {\r\n            this.addOutput(table.name_, \"Entity\");\r\n            \r\n            let fields = [];\r\n            \r\n            for (let field of table.columns) {\r\n                this.addOutput(field.name, field.type);\r\n                fields.push({ name: field.name, type: field.type });\r\n            }\r\n\r\n            this.properties = { Fields: fields };            \r\n        }\r\n\r\n        EntityNode.prototype.onExecute = function () {\r\n            this.setOutputData(0, this.getInputData(0));\r\n        };\r\n\r\n        EntityNode.title = name;\r\n        EntityNode.color = \"#00470f\";\r\n        EntityNode.bgcolor = \"#002307\";\r\n        LiteGraph.registerNodeType(\"Entity/\" + name, EntityNode);\r\n    }\r\n};\r\n\r\nconst creatCountBlock = () => {\r\n    function CountNode() {\r\n        this.addInput(\"Count\", \"Entity\");\r\n        this.addOutput(\"Count\", \"number\");\r\n    }\r\n\r\n    CountNode.prototype.onExecute = function () {\r\n    };\r\n\r\n    CountNode.title = \"Count\";\r\n    LiteGraph.registerNodeType(\"Operations/Count\", CountNode);\r\n}\r\n\r\nconst createForEachBlock = () => {\r\n\r\n    const adjustAgg = (value, widget, node) => {\r\n        node.properties.agg = value;\r\n    }\r\n\r\n    const adjustField1 = (value, widget, node) => {\r\n        node.properties.Field1 = value;\r\n    }\r\n\r\n    const adjustField2 = (value, widget, node) => {\r\n        node.properties.Field2 = value;\r\n    }\r\n\r\n    function ForEachNode() {\r\n        this.addInput(\"Entity\", \"Entity\");\r\n        this.addOutput(\"Output\", \"number\");\r\n        this.addWidget(\"combo\", \"Function\", \"\", adjustAgg, {values: [\"Count\", \"Sum\", \"Avg\", \"Min\", \"Max\"]});\r\n        this.addWidget(\"combo\", \"Field1\", \"\", adjustField1, {values: []});\r\n        this.addWidget(\"combo\", \"\", \"Per\", {values: [\"Per\"]});\r\n        this.addWidget(\"combo\", \"Field2\", \"\", adjustField2, {values: []});\r\n        this.properties = { Fields: [], Field1: \"\", Field2: \"\", agg: \"\" };\r\n    }\r\n\r\n    ForEachNode.prototype.onConnectionsChange = function (type, slotIndex, isConnected, link, ioSlot) {\r\n        if (isConnected) {\r\n            let node = this.graph.getNodeById(link.origin_id);\r\n            let fields = node.properties.Fields;\r\n            this.properties.Fields = fields;\r\n            this.widgets[1].options.values = fields.map(f => f.name);\r\n            this.widgets[3].options.values = fields.map(f => f.name);\r\n        }\r\n    }\r\n\r\n    ForEachNode.title = \"ForEach\";\r\n    LiteGraph.registerNodeType(\"Operations/ForEach\", ForEachNode);\r\n}\r\n\r\nconst createProjectionBlock = () => {\r\n    const adjustToggle = (value, widget, node) => {\r\n        for (let i = 0; i < node.widgets.length; i++) {\r\n            node.properties.Fields[i].value = node.widgets[i].value;\r\n        }\r\n\r\n        console.log(node.properties.Fields);\r\n    }\r\n    function ProjectionNode() {\r\n        this.addInput(\"Entity\", \"Entity\");\r\n        this.addOutput(\"Entity\", \"Entity\");\r\n        this.properties = { Fields: [] };\r\n    }\r\n\r\n    ProjectionNode.prototype.onConnectionsChange = function (type, slotIndex, isConnected, link, ioSlot) {\r\n        if (isConnected) {\r\n            console.log(this.widgets);\r\n            if (!this.widgets || this.widgets.length == 0) {\r\n\r\n                let node = graph.getNodeById(link.origin_id);\r\n                let f = [];\r\n                if (node.type.startsWith(\"Operations\")) {\r\n                    if (node.properties.Fields) {\r\n                        f = node.properties.Fields.map(field => field.name);\r\n                    }\r\n                }\r\n                else if (node.type.startsWith(\"Entity\")) {\r\n                    console.log(node.outputs);\r\n                    f = node.outputs.map(output => output.name);\r\n                    f.shift();\r\n                }\r\n                console.log(f);\r\n\r\n                f.forEach(field => {\r\n                    this.addWidget(\"toggle\", field, true, adjustToggle);\r\n                    this.properties.Fields.push({ \"name\": field, \"value\": true });\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            if (this.widgets) {\r\n                let l = this.widgets.length;\r\n                for (let i = 0; i < l; i++) {\r\n                    this.widgets.pop();\r\n                }\r\n            }\r\n            this.properties.Fields = [];\r\n        }\r\n    };\r\n\r\n    ProjectionNode.title = \"Projection\";\r\n    LiteGraph.registerNodeType(\"Operations/Projection\", ProjectionNode);\r\n}\r\nconst createFilterBlock = () => {\r\n    const setCustomValue = (value, widget, node) => {\r\n        node.properties.CustomValue = value;\r\n    };\r\n\r\n    const setOperation = (value, widget, node) => {\r\n        node.properties.Operation = value;\r\n    };\r\n\r\n    const adjustWidgets0 = (value, widget, node) => {\r\n        node.properties.Field = value;\r\n        let type;\r\n        for (let field of node.properties.Fields) {\r\n            if (field.name === value) {\r\n                type = field.type;\r\n            }\r\n        }\r\n\r\n        if (type === 'string') {\r\n            node.widgets[1].options.values = ['is the same as', 'starts with', 'ends with'];\r\n            node.widgets[1].value = 'is the same as';\r\n            node.properties.Operation = 'is the same as';\r\n\r\n            let stringFields = [];\r\n            for (let field of node.properties.Fields) {\r\n                if (field.type === 'string') {\r\n                    stringFields.push(field.name);\r\n                }\r\n            }\r\n\r\n            stringFields.push('external node');\r\n            stringFields.push('custom input');\r\n\r\n            node.widgets[2].options.values = stringFields;\r\n            node.widgets[2].value = stringFields[0];\r\n            node.properties.Field2 = stringFields[0];\r\n        }\r\n        else if (type === 'number') {\r\n            node.widgets[1].options.values = ['=', '<', '>', '<=', '>=', '!='];\r\n            node.widgets[1].value = '=';\r\n            node.properties.Operation = '=';\r\n\r\n            let numberFields = [];\r\n            for (let field of node.properties.Fields) {\r\n                if (field.type === 'number') {\r\n                    numberFields.push(field.name);\r\n                }\r\n            }\r\n\r\n            numberFields.push('external node');\r\n            numberFields.push('custom input');\r\n\r\n            node.widgets[2].options.values = numberFields;\r\n            node.widgets[2].value = numberFields[0];\r\n            node.properties.Field2 = numberFields[0];\r\n        }\r\n    };\r\n\r\n    const adjustWidgets2 = (value, widget, node) => {\r\n        node.properties.Field2 = value;\r\n        if (value === 'external node') {\r\n            // check if node has input 'value'\r\n            if (node.inputs.length <= 1) {\r\n                node.addInput('value');\r\n            }\r\n        }\r\n        else {\r\n            node.removeInput(1);\r\n        }\r\n\r\n        let type;\r\n        for (let field of node.properties.Fields) {\r\n            if (field.name === node.widgets[0].value) {\r\n                type = field.type;\r\n            }\r\n        }\r\n\r\n        if (value === 'custom input') {\r\n            // todo: make sure not to add widget if custom input already exists\r\n            if (type === 'string') {\r\n                node.addWidget(\"text\", \"Custom Input\", \"\", setCustomValue);\r\n            }\r\n            else if (type === 'number') {\r\n                node.addWidget(\"number\", \"Custom Input\", 0, setCustomValue);\r\n            }\r\n        }\r\n        else {\r\n            // remove last element from node.widgets\r\n            if (node.widgets.at(-1).name === 'Custom Input') {\r\n                node.widgets.pop();\r\n            }\r\n        }\r\n    };\r\n    function FilterNode() {\r\n        this.addProperty('Fields', [], 'array');\r\n        this.addInput(\"entity\");\r\n        this.addOutput(\"output\");\r\n        this.addWidget(\"combo\", \"Field\", \"Field\", adjustWidgets0, { \"values\": [''] });\r\n        this.addWidget(\"combo\", \"Operation\", '', setOperation, { \"values\": [''] });\r\n        this.addWidget(\"combo\", \"Field\", '', adjustWidgets2, { \"values\": [''] });\r\n        this.properties = { Field: \"\", Field2: \"\", CustomValue: \"\", Operation: \"\", Fields: [] };\r\n    }\r\n\r\n    FilterNode.prototype.onConnectionsChange = function (type, slotIndex, isConnected, link, ioSlot) {\r\n        if (isConnected) {\r\n            if (slotIndex === 0) {\r\n                let node = graph.getNodeById(link.origin_id);\r\n                let fieldValues = [];\r\n                let outputs = [];\r\n                outputs = node.properties.Fields;                    \r\n                \r\n                for (let i = 0; i < outputs.length; i++) {\r\n                    this.properties.Fields[i] = outputs[i];\r\n                    fieldValues.push(outputs[i].name);\r\n                }\r\n\r\n                this.widgets[0].options.values = fieldValues;\r\n            }\r\n            else if (slotIndex == 1) {\r\n                let node = graph.getNodeById(link.origin_id);\r\n                this.properties.CustomValue = node.properties.Output;\r\n            }\r\n        }\r\n    };\r\n\r\n    FilterNode.title = \"Filter\";\r\n    LiteGraph.registerNodeType(\"Operations/Filter\", FilterNode);\r\n};\r\n\r\nconst createDisplayBlock = showModal => {\r\n    const show = () => {\r\n        showModal(true);\r\n    }\r\n    function DisplayNode() {\r\n        this.addInput(\"entity\");\r\n        this.addWidget(\"button\", \"Run Query\", \"\", show);\r\n    }\r\n\r\n    DisplayNode.prototype.onConnectionsChange = function (type, slotIndex, isConnected, link, ioSlot) {\r\n        if (isConnected) {\r\n            this.addInput(\"entity\");\r\n        }\r\n        else {\r\n            this.removeInput(slotIndex);\r\n        }\r\n    };\r\n\r\n    DisplayNode.title = \"Display\";\r\n    DisplayNode.color = \"#00004d\";\r\n    DisplayNode.bgcolor = \"#000034\";\r\n    LiteGraph.registerNodeType(\"Display/Display\", DisplayNode);\r\n};\r\n\r\nconst getSQL = () => {\r\n    //[link_id, origin_id, origin_slot, target_id, target_slot, link_type];\r\n    console.log(graph.serialize());\r\n    let serialization = graph.serialize();\r\n\r\n    let nodes = serialization.nodes;\r\n    let links = serialization.links;\r\n\r\n    nodes.sort((a, b) => {\r\n        return a.order - b.order;\r\n    });\r\n\r\n    console.log(nodes, links);\r\n\r\n    axios.post('http://localhost:5000/', {\r\n        nodes: nodes,\r\n        links: links\r\n    }, { useCredentails: true }).\r\n        then(function (response) {\r\n            console.log(response.data);\r\n            setResponse(response.data.query, response.data.result, response.data.keys);\r\n        }).catch(function (error) {\r\n            console.log(error);\r\n        });\r\n};\r\n\r\nconst convertToJson = result => {\r\n    let json = result.split(\"(\");\r\n    // remove first and last element from array\r\n    json.shift();\r\n    json.pop();\r\n    // remove all close parenthesis\r\n    json = json.map(element => element.replace(/\\)/g, ''));\r\n\r\n    console.log(json);\r\n\r\n    return json;\r\n};\r\n\r\nexport { init, getSQL, convertToJson };","E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\components\\Modal\\index.js",["33","34"],"import React, { useState, useEffect } from 'react';\r\nimport DataTable from '../DataTable';\r\nimport './styles.css';\r\n\r\nconst Modal = ({ showModal: show, setShowModal: setShow, query, result, keys }) => {\r\n    const handleClose = () => {\r\n        setShow(false);\r\n    }\r\n\r\n    return (\r\n        <div className=\"modal\" style={{ \"display\": (show ? \"block\" : \"none\") }}>\r\n            <button onClick={handleClose}>&times;</button>\r\n            <p><DataTable keys={keys} result={result}></DataTable></p>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Modal;","E:\\School\\'21-F\\ECE464 Databases\\nodesql\\frontend\\src\\components\\DataTable\\index.js",["35","36"],"import React, { useState, useEffect } from 'react';\r\n\r\nconst DataTable = (props) => {\r\n    return (\r\n        <table style={{ textAlign: \"center\" }}>\r\n            <tr>\r\n                {props.keys.map((key, index) => {\r\n                    return <th key={index}>{key}</th>\r\n                })}\r\n            </tr>\r\n            {props.result.map((row, index) => {\r\n                return (\r\n                    <tr key={index}>\r\n                        {props.keys.map((key, index) => {\r\n                            return <td key={index}>{row[key]}</td>\r\n                        })}\r\n                    </tr>\r\n                )\r\n            })}\r\n        </table>\r\n    );\r\n}\r\n\r\nexport default DataTable;",{"ruleId":"37","severity":1,"message":"38","line":5,"column":24,"nodeType":"39","messageId":"40","endLine":5,"endColumn":37},{"ruleId":"37","severity":1,"message":"41","line":7,"column":9,"nodeType":"39","messageId":"40","endLine":7,"endColumn":19},{"ruleId":"42","severity":1,"message":"43","line":46,"column":13,"nodeType":"44","endLine":46,"endColumn":35},{"ruleId":"37","severity":1,"message":"45","line":52,"column":9,"nodeType":"39","messageId":"40","endLine":52,"endColumn":15},{"ruleId":"46","severity":1,"message":"47","line":115,"column":54,"nodeType":"48","messageId":"49","endLine":115,"endColumn":56},{"ruleId":"46","severity":1,"message":"47","line":269,"column":32,"nodeType":"48","messageId":"49","endLine":269,"endColumn":34},{"ruleId":"50","severity":1,"message":"51","line":321,"column":33,"nodeType":"52","messageId":"53","endLine":321,"endColumn":34,"fix":"54"},{"ruleId":"37","severity":1,"message":"55","line":1,"column":17,"nodeType":"39","messageId":"40","endLine":1,"endColumn":25},{"ruleId":"37","severity":1,"message":"56","line":1,"column":27,"nodeType":"39","messageId":"40","endLine":1,"endColumn":36},{"ruleId":"37","severity":1,"message":"55","line":1,"column":17,"nodeType":"39","messageId":"40","endLine":1,"endColumn":25},{"ruleId":"37","severity":1,"message":"56","line":1,"column":27,"nodeType":"39","messageId":"40","endLine":1,"endColumn":36},"no-unused-vars","'convertToJson' is defined but never used.","Identifier","unusedVar","'operations' is assigned a value but never used.","react-hooks/exhaustive-deps","Assignments to the 'graph' variable from inside React Hook useEffect will be lost after each render. To preserve the value over time, store it in a useRef Hook and keep the mutable value in the '.current' property. Otherwise, you can move this variable directly inside useEffect.","NewExpression","'canvas' is assigned a value but never used.","eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","dot-location","Expected dot to be on same line as property.","MemberExpression","expectedDotBeforeProperty",{"range":"57","text":"58"},"'useState' is defined but never used.","'useEffect' is defined but never used.",[10749,10760],"\r\n        ."]